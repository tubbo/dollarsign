<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>dollarsign.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Dollarsign.html">Dollarsign</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Dollarsign.html#each">each</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Dollarsign.html#iterator">iterator</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Dollarsign.html#toString">toString</a></span></li><li class="nav-heading">Modules</li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-ajax.html">ajax</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-ajax.html#.load">load</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-ajax.html#.serialize">serialize</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-css.html">css</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-css.html#.addClass">addClass</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-css.html#.css">css</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-css.html#.hasClass">hasClass</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-css.html#.removeClass">removeClass</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-css.html#.toggleClass">toggleClass</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-dom.html">dom</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-dom.html#.attr">attr</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-dom.html#.closest">closest</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-dom.html#.find">find</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-dom.html#.html">html</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-dom.html#.text">text</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-enumeration.html">enumeration</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-enumeration.html#.reduce">reduce</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-events.html">events</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-events.html#.fire">fire</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-events.html#.off">off</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-events.html#.on">on</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#$">$</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#fn">fn</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">dollarsign.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { $ } from "./factory";

/**
 * The Dollarsign object represents a collection of DOM elements grouped by the given
 * `selector`. Wraps basic browser functionality into a more consistent
 * and concise API. The implementation of this class contains only the
 * bare minimum necessary to implement all of Dollarsign's
 * functionality, and the rest of it is implemented in various modules.
 *
 * @class
 */
export class Dollarsign {
  /**
   * Query the given DOM object (or scope) for elements matching selector.
   *
   * @constructor
   * @param {Element | Document} scope - DOM object to manipulate
   * @param {string} selector - Element query
   */
  constructor(scope, selector) {
    this.document = scope;
    this.selector = selector;
    this.events = {};

    for (const [name, plugin] of Object.entries($.fn)) {
      if (!plugin) throw new Error(`Couldn't load plugin "${name}"`);

      this[name] = plugin.bind(this);
    }

    return new Proxy(this, {
      get: (target, propKey, receiver) => {
        if (typeof propKey === "string" &amp;&amp; this.#isSafeArrayIndex(propKey)) {
          return Reflect.get(this.elements, propKey);
        }
        return Reflect.get(target, propKey, receiver);
      },
      set: (target, propKey, value, receiver) => {
        if (typeof propKey === "string" &amp;&amp; this.#isSafeArrayIndex(propKey)) {
          return Reflect.set(this.elements, propKey, value);
        }
        return Reflect.set(target, propKey, value, receiver);
      },
    });
  }

  /**
   * Test whether the given key that we are trying to resolve can be
   * used as an Array index. This is for internal use only, and allows
   * for Array-like behavior such as responding to `$('.selector')[0]`.
   *
   * @param {string | number} propKey
   * @return {boolean}
   * @private
   */
  #isSafeArrayIndex(propKey) {
    const uint = Number.parseInt(propKey, 10);
    const s = uint + "";

    return propKey === s &amp;&amp; uint !== 0xffffffff &amp;&amp; uint &lt; this.length;
  }

  /**
   * All elements matching the given `selector`. This is calculated
   * using `querySelectorAll()` if a string selector is given.
   * Otherwise, we assume the selector is a wrapped element and return
   * it as a single-position Array.
   *
   * @return {Array&lt;Element>}
   * @readonly
   */
  get elements() {
    if (typeof this.selector !== "string") return [this.selector];
    if (
      Array.isArray(this.document) ||
      NodeList.prototype.isPrototypeOf(this.document)
    ) {
      const elements = [];

      this.document.forEach((document) => {
        document.querySelectorAll(this.selector).forEach((element) => {
          if (!elements.includes(element)) {
            elements.push(element);
          }
        });
      });

      return elements;
    }

    return this.document.querySelectorAll(this.selector);
  }

  /**
   * Counts results in the query. As this depends on `this.elements`, it
   * is also read-only and is calculated based on the value of that
   * computed attribute.
   *
   * @return {number} Count of all elements matched by the selector.
   * @readonly
   */
  get length() {
    return this.elements.length;
  }

  /**
   * Allow iteration over this object using `for..of` loops. This is
   * also used to iterate over objects with `this.each()`, but with
   * that function we provide a bit more functionality. This will only
   * iterate over the elements and not change the `this` or wrap each
   * element in a Dollarsign object.
   * @name iterator
   * @function
   * @memberof Dollarsign
   * @instance
   * @generator
   */
  *[Symbol.iterator]() {
    for (const element of this.elements) {
      yield element;
    }
  }

  /**
   * This allows us to identify Dollarsign objects without needing to
   * use `instanceof`. In bundled environments, `instanceof` doesn't
   * work because the class names can change.
   *
   * @name toString
   * @function
   * @memberof Dollarsign
   * @instance
   */
  get [Symbol.toStringTag]() {
    return "Dollarsign";
  }

  /**
   * Function executed when iterating over a collection of DOM elements.
   *
   * @callback Dollarsign~elementIterator
   * @param {Dollarsign} element - Each element selected from the DOM.
   * @param {Number} index - Index number of each element in the Array.
   */

  /**
   * Iterate over every element with the given callback function.
   *
   * @param {elementIterator} callback - Function to call on each iteration.
   * @return {Dollarsign} this object
   */
  each(callback) {
    for (const element of this) {
      const item = new Dollarsign(this.scope, element);
      const iterate = callback.bind(item);

      iterate(element);
    }

    return this;
  }
}
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.4</a> on Sun Oct 03 2021 04:19:15 GMT+0000 (Coordinated Universal Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
